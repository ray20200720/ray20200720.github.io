<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="想了解怎麼開發Visual Studio的延伸模組(Extension)"><link rel="stylesheet" type="text/css" href="/css/normalize.css"><link rel="stylesheet" type="text/css" href="/css/highlight.css"><link rel="stylesheet" type="text/css" href="/css/noise.css"><title>開發Visual Studio 2019 延伸模組範例 | ITHelp</title><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><meta name="generator" content="Hexo 6.3.0"></head><body><article class="wrapper"><div class="post-main"><div class="nav"><nav class="container"><a class="sidebar-nav-item active" href="/">Home</a><a class="sidebar-nav-item" href="/archives">Archives</a></nav><div class="container post-meta"><div class="post-time">2024-01-05</div></div></div><div class="container post-header"><h1>開發Visual Studio 2019 延伸模組範例</h1></div><div class="container post-toc"><details class="toc"><summary class="toc-accordion">Table of Contents</summary><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E8%A3%9D-Visual-Studio-SDK"><span class="toc-number">1.</span> <span class="toc-text">安裝 Visual Studio SDK</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BB%BA%E7%AB%8B%E6%96%B0%E5%B0%88%E6%A1%88%E5%90%8D%E7%A8%B1%E7%82%BA-HelloWorld"><span class="toc-number">2.</span> <span class="toc-text">建立新專案名稱為 HelloWorld</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Add-a-custom-command"><span class="toc-number">3.</span> <span class="toc-text">Add a custom command</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Modify-the-source-code"><span class="toc-number">4.</span> <span class="toc-text">Modify the source code</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Run-it"><span class="toc-number">5.</span> <span class="toc-text">Run it</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#How-to-reset-Experimental-instance-of-Visual-Studio"><span class="toc-number">6.</span> <span class="toc-text">How to reset Experimental instance of Visual Studio</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8F%83%E8%80%83%E4%BE%86%E6%BA%90"><span class="toc-number">7.</span> <span class="toc-text">參考來源</span></a></li></ol></details></div><div class="container post-content"><p>想了解怎麼開發Visual Studio的延伸模組(Extension)</p>
<h1 id="安裝-Visual-Studio-SDK"><a href="#安裝-Visual-Studio-SDK" class="headerlink" title="安裝 Visual Studio SDK"></a>安裝 Visual Studio SDK</h1><p>啟動 <code>Visual Studio Installer</code>, 點選 <code>修改</code></p>
<p><img src="/pic/VSIX/installer.png" alt="Visual Studio Installer"></p>
<p>在 <code>工作負載</code> 頁籤 找到 <code>Visual Studio 擴充功能開發</code>, 勾選後點 <code>關閉</code> 進行安裝</p>
<p><img src="/pic/VSIX/sdk.png" alt="Visual Studio SDK"></p>
<h1 id="建立新專案名稱為-HelloWorld"><a href="#建立新專案名稱為-HelloWorld" class="headerlink" title="建立新專案名稱為 HelloWorld"></a>建立新專案名稱為 HelloWorld</h1><p>Step 1. From the File menu, select New &gt; Project. Search for “vsix” and select the Visual C# VSIX Project and then Next.</p>
<p>Step 2. Enter “HelloWorld” for the Project name and select Create.</p>
<h1 id="Add-a-custom-command"><a href="#Add-a-custom-command" class="headerlink" title="Add a custom command"></a>Add a custom command</h1><p>Step 1. If you select the .vsixmanifest manifest file, you can see what options are changeable, such as description, author, and version.</p>
<p>Step 2. Right-click the project (not the solution). On the context menu, select Add, and then New Item.</p>
<p>Step 3. Select the Extensibility section, and then choose Command.</p>
<p>Step 4. In the Name field at the bottom, enter a filename such as Command.cs.</p>
<p>Your new command file is visible in Solution Explorer. Under the Resources node, you’ll find other files related to your command. For example, if you wish to modify the image, the PNG file is here.</p>
<h1 id="Modify-the-source-code"><a href="#Modify-the-source-code" class="headerlink" title="Modify the source code"></a>Modify the source code</h1><p>Step 1. In Solution Explorer, find the VSCT file for your extension VS package. In this case, it will be called HelloWorldPackage.vsct.</p>
<p>Step 2. Change the ButtonText parameter to Say Hello World!.</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;Button guid=<span class="string">&quot;guidCommandPackageCmdSet&quot;</span> id=<span class="string">&quot;CommandId&quot;</span> priority=<span class="string">&quot;0x0100&quot;</span> type=<span class="string">&quot;Button&quot;</span>&gt;</span><br><span class="line">   &lt;Parent guid=<span class="string">&quot;guidCommandPackageCmdSet&quot;</span> id=<span class="string">&quot;MyMenuGroup&quot;</span> /&gt;</span><br><span class="line">   &lt;Icon guid=<span class="string">&quot;guidImages&quot;</span> id=<span class="string">&quot;bmpPic1&quot;</span> /&gt;</span><br><span class="line">   &lt;Strings&gt;</span><br><span class="line">      &lt;ButtonText&gt;Say Hello World!&lt;/ButtonText&gt;</span><br><span class="line">   &lt;/Strings&gt;</span><br><span class="line">&lt;/Button&gt;</span><br></pre></td></tr></table></figure>
<p>Step 3. Go back to Solution Explorer and find the Command.cs file. In the Execute method, change the string message from string.Format(..) to Hello World!.</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Execute</span>(<span class="params"><span class="built_in">object</span> sender, EventArgs e</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">  ThreadHelper.ThrowIfNotOnUIThread();</span><br><span class="line">  <span class="built_in">string</span> message = <span class="string">&quot;Hello World!&quot;</span>;</span><br><span class="line">  <span class="built_in">string</span> title = <span class="string">&quot;Command&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Show a message box to prove we were here</span></span><br><span class="line">  VsShellUtilities.ShowMessageBox(</span><br><span class="line">      <span class="keyword">this</span>.ServiceProvider,</span><br><span class="line">      message,</span><br><span class="line">      title,</span><br><span class="line">      OLEMSGICON.OLEMSGICON_INFO,</span><br><span class="line">      OLEMSGBUTTON.OLEMSGBUTTON_OK,</span><br><span class="line">      OLEMSGDEFBUTTON.OLEMSGDEFBUTTON_FIRST);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Run-it"><a href="#Run-it" class="headerlink" title="Run it"></a>Run it</h1><p>ou can now run the source code in the Visual Studio Experimental Instance.</p>
<p>Step 1. Press F5 to run the Start Debugging command. This command builds your project and starts the debugger, launching a new instance of Visual Studio called the Experimental Instance.</p>
<p>Step 2. On the Tools menu of the Experimental Instance, click Say Hello World!.</p>
<h1 id="How-to-reset-Experimental-instance-of-Visual-Studio"><a href="#How-to-reset-Experimental-instance-of-Visual-Studio" class="headerlink" title="How to reset Experimental instance of Visual Studio"></a>How to reset Experimental instance of Visual Studio</h1><p>執行底下的捷徑</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Visual Studio 2019\Microsoft Visual Studio SDK\Tools\Reset the Visual Studio 2019 Experimental Instance</span><br></pre></td></tr></table></figure>

<h1 id="參考來源"><a href="#參考來源" class="headerlink" title="參考來源"></a>參考來源</h1><ul>
<li><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/visualstudio/extensibility/installing-the-visual-studio-sdk?view=vs-2022">Install the Visual Studio SDK</a></li>
<li><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/visualstudio/extensibility/extensibility-hello-world?view=vs-2022">Tutorial - Create your first extension: Hello World</a></li>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/54958880/resetting-experimental-instance-of-visual-studio">Resetting Experimental instance of Visual Studio</a></li>
</ul>
</div></div><div class="post-main post-comment"></div></article><link rel="stylesheet" type="text/css" href="//cdn.bootcdn.net/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcdn.net/ajax/libs/lato-font/3.0.0/css/lato-font.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcdn.net/ajax/libs/fancybox/2.1.5/jquery.fancybox.css"><script src="//cdn.bootcdn.net/ajax/libs/jquery/2.0.3/jquery.min.js"></script><script src="//cdn.bootcdn.net/ajax/libs/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script>$(document).ready(function() {
  $(".fancybox").fancybox();
});
</script></body></html>